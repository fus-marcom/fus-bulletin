<script src="http://code.jquery.com/jquery-2.1.1.min.js"></script>
<script src="https://cdn.auth0.com/js/lock-passwordless-1.0.min.js"></script>

<script type="text/javascript">

//parse hash on page load
$(document).ready(function(){
  var lock = new Auth0LockPasswordless('WHlJ62IAghlqzYtxx9JqocaOFHe2ikdw', 'jesseweigel.auth0.com');

  if (!localStorage.id_token !== false) {
  var hash = lock.parseHash(window.location.hash);

  if (hash && hash.error) {
    alert('There was an error: ' + hash.error + '\n' + hash.error_description);
  } else if (hash && hash.id_token) {
    //use id_token for retrieving profile.
    localStorage.setItem('id_token', hash.id_token);
    //retrieve profile
    lock.getProfile(hash.id_token, function (err, profile) {
      if (err){
        //handle err

        function login(){
          // Initialize Passwordless Lock instance
          var lock = new Auth0LockPasswordless('WHlJ62IAghlqzYtxx9JqocaOFHe2ikdw', 'jesseweigel.auth0.com');
          // Open the lock in Email Magic Link mode
          lock.magiclink();
        }

        login();
      } else {
        //use user profile
        console.log(profile);
      }
    });
  }
}

lock.getProfile(localStorage.id_token, function (err, profile) {
  if(err) {
    console.log(`error ${err}`);

  } else {
    console.log(profile);
  }
});
});



</script>
